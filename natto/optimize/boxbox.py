# %%
##################
# harmless definitions :) 
#################
from natto.out import draw_boxplot as dbox 
import structout as so
from natto.out.quality import spacemap
from natto import input 
import umap 
import numpy as np 
from sklearn.linear_model import LinearRegression as LR
from sklearn.linear_model import HuberRegressor as HR
from sklearn.linear_model import RANSACRegressor
from scipy.stats import spearmanr as spear
from lmz import *
from matplotlib import pyplot as plt 
import natto.out.draw as draw
from ubergauss import draw as ugdraw

dist_raw = np.array([[[0.9112897696832768, 0.8032621631875927, 0.8511958458355072, 0.8064184259627949, 0.8539583767056467, 0.9637376842685451, 0.8547761061618325, 0.8367403237590071, 0.9042655422270729, 0.8222095449959083, 0.7892893897963836, 0.893376081482888, 0.7896788419213039, 0.8507705937372739, 0.9160069645065374, 0.88652712516218, 0.8671396532063166, 0.9368696921289784, 0.9316587353494372, 0.8207780847610999], [0.220193461485963, 0.16859651870724882, 0.3395692421915191, 0.1328057650651663, 0.16672052140483207, 0.3360300323355583, 0.24395844576347483, 0.11281674446018133, 0.29762768229988845, 0.1554006202564755, 0.11989746549137732, 0.21262383140098376, 0.28580128567298696, 0.0908816263976133, 0.17093318049050477, 0.24019890463869056, 0.10729426053103713, 0.21265762827358015, 0.19211699854593992, 0.2871986413070256], [0.6290273279334763, 0.559372923161304, 0.6112303569319594, 0.6377685956867487, 0.5862603282616994, 0.5800428528875222, 0.5783284242017247, 0.5630935998544281, 0.5677503437234841, 0.6286235852887231, 0.5594354531943786, 0.5908499078429045, 0.6191665666964703, 0.6275750821410351, 0.5955532084116779, 0.5217266688719061, 0.5452283615534905, 0.6339693406973933, 0.5322743136376505, 0.6308118459602527], [0.018389580704810837, 0.08043145934627141, 0.148973599880794, 0.19195280655130423, 0.2573984544678637, 0.22343532618780781, 0.13390573503836958, 0.28402581662900905, 0.09052042769625224, 0.09027966565589274, 0.15362822774836865, 0.21421227004220206, 0.1944649539309479, 0.23596717214193386, 0.14249412681457257, 0.0021028587748752737, 0.11878296112564037, 0.0548820725374655, 0.11298934030842005, 0.20848940464361912], [0.2040963199520478, 0.25716186741355646, 0.28387939488455516, 0.2145488103476923, 0.2327472645053417, 0.21861348099388694, 0.27717099954731916, 0.23946876225714647, 0.2247799004029595, 0.22915814905470708, 0.2307993678286808, 0.24522649413484016, 0.1941533092374452, 0.24099028895150515, 0.24907697639100826, 0.24182133674154735, 0.25683797225833843, 0.24673838920311714, 0.31660170141499916, 0.2515761240894167], [0.21210501585383623, 0.1565073228874551, 0.29794378003711414, 0.1661578803316108, 0.1684249559050153, 0.1533139186880713, 0.18190636220894146, 0.16615861877264085, 0.24608253066262875, 0.2598409771610603, 0.03382184082218631, 0.3085778617385404, 0.2635211997860243, 0.3167723961408106, 0.1466994793129567, 0.16272622790907676, 0.156114662896671, 0.11121767245543758, 0.14426635440421381, 0.2196878268030852], [0.1017629141888034, 0.17782763611112762, 0.22334244655899677, 0.05629441550219167, 0.2263984756075794, 0.22173506711987814, 0.290564695430104, 0.2730807714704158, 0.23181148788606015, 0.1806369420131925, 0.28494418859686754, 0.20153240956974675, 0.3216376800862149, 0.2010340541192524, 0.1158665512781636, 0.15571837832642627, 0.10531936793013065, 0.23996746131199018, 0.3251037890321542, 0.21803451701194912], [0.18534834105252254, 0.1735167362607095, 0.2363208064337647, 0.06233505120180245, 0.06188596959143045, 0.24491697866798381, 0.17062132494559865, 0.2204947784378498, 0.14348845668268242, 0.041503541273373794, 0.19499641526643538, 0.22846543980580655, 0.2561370965381155, 0.09037364170283319, 0.24279432271405024, 0.2133411297283916, 0.17957804145494874, 0.18079723870710082, 0.06630918280307661, 0.06823941721565968], [0.12970836819128143, 0.24523575059949312, 0.28396038279300795, 0.04871044798602549, 0.18625239536810495, 0.13281420810007155, 0.20374485533603212, 0.18329112248276777, 0.10668104203228168, 0.16026299223083182, 0.18165362905716173, 0.31993919827434647, 0.31819477050104944, 0.3776386443014539, 0.15940250409399093, 0.09901048431118276, 0.26960847074134403, 0.1760289251394293, 0.014701952774196283, 0.12197691121551499]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.9090260829266636, 0.8727841997426623, 0.7814171450058499, 0.8515386295316095, 0.8660071032887156, 0.8059372932064197, 0.7671517384098959, 0.9121810456411839, 0.7629272376308573, 1.0, 0.7729438442393537, 1.0, 0.9544043664644547, 0.8898276680696323, 0.7493358655788827, 0.8856780898168567, 0.7930014020638582, 0.9761415748117065, 0.8255877732683062, 0.792024104148378], [0.24459244669474708, 0.2244612026825141, 0.069568258201516, 0.16232283098122594, 0.185372940032493, 0.14965817154016223, 0.3242362188368854, 0.18390949600087073, 0.12584601758769587, 0.10617135792504853, 0.1266180260294785, 0.14024874761197453, 0.08079786221523286, 0.21908832197127043, 0.3098496620283612, 0.10001716951949337, 0.2545662737679702, 0.1854503147118171, 0.07695041601300039, 0.2138756691380443], [0.16674966670978436, 0.1898261282068969, 0.1969441078491479, 0.17349117224667843, 0.07961025435531913, 0.12787095902288084, 0.22750637503386378, 0.13887749892501647, 0.22049691285933035, 0.14936176997741024, 0.18017381705866253, 0.14423597074941147, 0.27635373862246787, 0.1802295111952927, 0.24640068107651464, 0.1357894177267004, 0.26458877801839764, 0.08379328870701122, 0.1649061667068909, 0.1818474974311904], [0.2884741843733015, 0.19718495626531143, 0.4023353598647313, 0.18064987289314421, 0.20035426670649234, 0.12165662098904625, 0.2332736250079797, 0.28910713971187724, 0.1593376659096505, 0.17109455545414362, 0.2443542447093718, 0.17285757649266767, 0.16782547844015636, 0.20690654181132606, 0.16355035740334695, 0.3964098977494222, 0.30980030882622395, 0.20208255492289096, 0.23611036599453397, 0.1759994090538161], [0.41628395530912937, 0.46121876584702015, 0.3968426058663663, 0.4549996503862691, 0.4613478662553457, 0.38199408347176805, 0.33718600157622836, 0.481971035918784, 0.42912130281659816, 0.44391065842618455, 0.4247648720324259, 0.34335550553776517, 0.45687360299446417, 0.4080336932206139, 0.4515319259365459, 0.36706921794707553, 0.47232666941798357, 0.5146857272852772, 0.32565413027100293, 0.3915134920892578], [0.40002258705112437, 0.4911115758748645, 0.3513581511764978, 0.44482907493915264, 0.4152656226247277, 0.399299323238893, 0.4121764449908147, 0.3547991314208237, 0.3569004982595447, 0.4192153201109839, 0.45759167706278947, 0.46234790625526784, 0.3793930199408312, 0.4065819761642265, 0.45594475617289804, 0.3967798637909556, 0.4393252978327753, 0.3703681183961977, 0.41038235793842137, 0.41640405313700385], [0.4889108399955372, 0.4510556792490153, 0.501602459053721, 0.5167291695731907, 0.5437308426051962, 0.49432783789335455, 0.43057439253008417, 0.5096689045893271, 0.4263622564274698, 0.4505370804943309, 0.482385441972599, 0.5041549644115852, 0.48568966606445424, 0.45588678765859336, 0.42111537070059923, 0.49326629135887745, 0.41874172729219833, 0.4565716629126159, 0.5157289552459817, 0.4179340404783604], [0.5098143253788542, 0.5396265560541281, 0.4872134103137257, 0.4485215004209689, 0.5145459075331345, 0.5822129124231982, 0.534754165513649, 0.5562877144282048, 0.5237961237820936, 0.5004398920341697, 0.49243040283516737, 0.46350931363684883, 0.5792463318060679, 0.554970824449512, 0.4921755631183656, 0.544552252902153, 0.5068754489364884, 0.4915831799927508, 0.5122686625913263, 0.5948492281566301]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.8598165268399713, 0.7968994752836998, 0.8596738471649094, 0.8445288536823207, 0.9176514062669734, 0.884967976969204, 0.7529911364239997, 0.8398981251360834, 0.8316472143557231, 0.825388127250314, 0.7959177281514999, 0.93382118070002, 0.9727301721920428, 0.8471290941126752, 0.8805039442614354, 0.7711774366322143, 0.9131299017610467, 0.7768879489658376, 0.8034861724051233, 0.8640850886565224], [0.09936975972290298, 0.21773442786789826, 0.2814536349322048, 0.025245460216718255, 0.1256473029096097, -3.705615788821837e-05, -0.007055484347740302, 0.10069293952211607, 0.15754245940902278, 0.1013976127036636, 0.11738983825415132, 0.13129226906059838, 0.1943696711735021, 0.06327222828472137, 0.18048209681978147, 0.18837425360720966, 0.16336615851835143, 0.13651827214220674, 0.13701694623511296, 0.07684761651550838], [0.33203158836303365, 0.3813227349221484, 0.3135697679026655, 0.3421060766660985, 0.314049522243211, 0.33135224150810455, 0.3614042673739745, 0.33094440809767145, 0.3054717607805597, 0.36629683382236705, 0.3293230126829063, 0.34510332445639363, 0.3026656320759453, 0.2971503983402235, 0.336663703648793, 0.37548925370150554, 0.33907919269159836, 0.28204291322977354, 0.4372374223517315, 0.32262701526093657], [0.1797192917287724, 0.14416478222089743, 0.2324730030192898, 0.12265913142239808, 0.12267784599268296, 0.2061014584306206, 0.10822043377232422, 0.31392323161740576, 0.06362852394527506, 0.16265201706799254, 0.00340012461158564, 0.06247047105754007, 0.11911199672217126, 0.07292618376093299, 0.11991557991100603, 0.07258794526441843, 0.1674290805101099, 0.17086052481489833, 0.15623757034805918, 0.15541631298478756], [0.18429428226910524, 0.18122137398832328, 0.24185102016558602, 0.10222406106250416, 0.12248025723722858, 0.15114850583701728, 0.2151899037022744, 0.07536722035338819, 0.03865116817988425, 0.04577652083083929, 0.11345585788546869, 0.1421738127772004, 0.15922308558256104, 0.08638238012795975, 0.13144584219429645, 0.10653476599828707, 0.14131562285227037, 0.1316115977567408, 0.31687016273383534, 0.11641920053997566], [0.17659117518866144, 0.08371910279850775, 0.2765612034046618, 0.14446342023386816, 0.12471273980899532, 0.23114731057821217, 0.12118062860475327, 0.03992017793487378, 0.10490865471904198, 0.1522405640528095, 0.09713303796326508, 0.11557389991460026, 0.06520797526991708, 0.1372088475599489, 0.029900945397207838, 0.16849108402427934, 0.008428136633781806, 0.10418455857249335, 0.11755472680934212, 0.1668275839004425], [0.10326718203843262, 0.16868137799592908, 0.3585943373242347, 0.268726946445809, 0.1648584458592685, 0.03257148120070201, 0.2501558862018304, 0.1386595796782439, 0.16316036561147512, 0.1219341539348469, 0.266187074195035, 0.19031505196679802, 0.3148204543600476, 0.04372906819595318, 0.26119810666150645, 0.16616289130728126, 0.22546564014882556, 0.12434932749214431, 0.09705449929714216, 0.2430346501031037]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7880919408199378, 0.9170887746912598, 0.8400637905925411, 0.8049746534028571, 0.7415721301261258, 0.7653449111736059, 0.7932269356567421, 0.9524395591353749, 0.9352529952775877, 0.9029796071688244, 0.8408857408909118, 0.8229336713397353, 0.843435399649985, 0.8239872489506628, 0.8195060966663746, 0.8900282075208081, 0.8804113351174768, 0.7954854758081483, 0.7785202673133688, 0.935914337938573], [0.24409443634650702, 0.1616188157647193, 0.2087297173095466, 0.1170148351874405, 0.21756608817082018, 0.23140503832387524, 0.23810708539435113, 0.25996393296226206, 0.18922809405363353, 0.21421420019837836, 0.1987318731025963, 0.2521550989070244, 0.22578005425404712, 0.3700300918630345, 0.2164734578044832, 0.20128401073918623, 0.18854555950312374, 0.2571881503658015, 0.17932465232101424, 0.20741913330165065], [0.14170061804493106, 0.03936602119277319, 0.04379522889051919, 0.16383263793858954, 0.09624614152629404, 0.0863086492478302, 0.07899731076171737, 0.07891370486865482, 0.16450158010301744, 0.11775955531305093, 0.07029555738937138, 0.09852252977347035, 0.12839266887427642, 0.08380577490390477, 0.08038655781907834, 0.02484936591756916, 0.0995034597943755, 0.0974475827364054, 0.10203701076216717, 0.1753829417346219], [0.35657492427182547, 0.35073028803994316, 0.27210918271797924, 0.3485828726507345, 0.2625294313539335, 0.25392007061937943, 0.19647065368538869, 0.29683898828235544, 0.3296393201671934, 0.3421222686863174, 0.20250252327322682, 0.34765747084635645, 0.3658538374167415, 0.40427452814260156, 0.2566576373243796, 0.3395301996172905, 0.38251716224231325, 0.34547852445642024, 0.1423573751802451, 0.3018305563148685], [0.06556529495810237, 0.22527706905940031, 0.13338741520354638, 0.11276333941268077, 0.1286080792389431, 0.19889024088718443, 0.16477226760100794, 0.17869473757266507, 0.13577453508314474, 0.17036512136329798, 0.11461707424558189, 0.17039561499662037, 0.11415963295479127, 0.037357573265469866, 0.17465007625482565, 0.029530991532929374, 0.14757406327863384, 0.09892906908815575, 0.08904699366248109, 0.22375015677271703], [0.2403924936740278, 0.26477841428413984, 0.059253197583698694, 0.10708836441473708, 0.10653522403271898, 0.13284900481486003, 0.11048486969198026, 0.15732515226655797, 0.09027416952598123, 0.16811088457961015, 0.06674165387680887, 0.17817598519077374, 0.0613917675736849, 0.08851866290181441, 0.18412258327995587, 0.0715523651117911, 0.07821665633224811, 0.3163080021626661, 0.1532822545193559, 0.10688721995237933]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7998193899507731, 0.8628780160616689, 0.9991458972460107, 0.7671943885462171, 0.9356854391461663, 0.9712600175572154, 0.9250888526425102, 0.8353120939357365, 0.9562570622832316, 0.8602328115609004, 0.8995238724640028, 0.8961917389135133, 0.9337075170331376, 0.9246249863647319, 0.8830086240222534, 0.7713644237356017, 0.9076606832664257, 0.8319003284979369, 0.9366150331319959, 0.8606008894742238], [0.2789175013343737, 0.14068397797700818, 0.3065326626888505, 0.1407874529498537, 0.3088397980340623, 0.24681967758001358, 0.14299590978386414, 0.2114233817570912, 0.10598297566194975, 0.17979104249287164, 0.15918289125590798, 0.1200375902713663, 0.10791312490379655, 0.24973735876733913, 0.18514732794554684, 0.14786314449115454, 0.1717914673565874, 0.09799341468249818, 0.1596283499805422, 0.1520680102747163], [0.44378392179914306, 0.32925925396796335, 0.20826291021003707, 0.40959205378134494, 0.30165040162559653, 0.3170819418210603, 0.4370812983922232, 0.23794926515538728, 0.35526831629258143, 0.28230879118275426, 0.28626438810863475, 0.48762351817876354, 0.4006662504962564, 0.2990906271401283, 0.24251445124173812, 0.3519852470645935, 0.4211639644006627, 0.26286225911930206, 0.3577828428935072, 0.3293607387329342], [0.33466350685524404, 0.3439103054809389, 0.030445724030834263, 0.19921415609766466, 0.3693686810483766, 0.282504574242167, 0.25620040489368795, 0.24347366162217046, 0.16482188289998304, 0.24188283856655293, 0.270652891496503, 0.19646644401103772, 0.5107413945801481, 0.06689219646646685, 0.1964088140456317, 0.44823266317321, 0.16457551924337124, 0.2967750987052147, 0.30737552409358865, 0.1433867423841837], [0.09202303230760295, 0.25190906543779484, 0.1350096290284758, 0.18664551284237615, 0.14289861183284225, 0.16050751747472333, 0.3114374009489807, 0.21633160845036112, 0.35362873939956574, 0.19216404918079508, 0.10929212696792308, 0.14461101926769662, 0.2286429563130367, 0.09621197651732326, 0.0947327299700094, 0.21745777260191776, 0.18812235607719888, 0.23487042877806566, 0.07086074316921316, 0.19191764892269408]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7974866663544421, 0.7460620432760454, 1.0, 0.7631654251172336, 0.9309645041569281, 0.7872379201515144, 0.7017744254321466, 0.8271328809292042, 0.8703214594712417, 0.7623235731255554, 0.9980612923018357, 0.8537125552267877, 0.7401816392881982, 0.7814416007427403, 0.9320959410209991, 0.9462405795654316, 0.8161033751366837, 0.8111758385024848, 0.7833918489069225, 0.7657670754441896], [0.4117913497793597, 0.40395695368704254, 0.3478010238043896, 0.36565850833933067, 0.3516169966618407, 0.33913501765436843, 0.45435299117674943, 0.39584156168086987, 0.4798531432176835, 0.3031400198947922, 0.31210813672287224, 0.3379600759038289, 0.2726665218536409, 0.3504636647845836, 0.408155470380237, 0.3545705576753337, 0.45538770593334443, 0.3149316730054427, 0.26150466060524075, 0.31069616749977824], [0.3149506430672889, 0.32222295996572775, 0.32666136168095383, 0.31273680010391364, 0.3208107799495292, 0.2730042310129731, 0.3631829705229609, 0.3997429986994488, 0.36258112658256647, 0.4402271629529729, 0.44488471372086147, 0.3604667759113773, 0.2990708090675693, 0.3683326296844403, 0.26328794988207643, 0.34391587935763984, 0.3727876648569734, 0.3056545005917446, 0.32004181670740445, 0.3205818048782386], [0.4161982515291036, 0.45462992346467274, 0.4023924741208832, 0.3101379911638323, 0.29404575285427803, 0.4025239313714111, 0.495594079386976, 0.348412376710319, 0.4302068415225152, 0.2985334829711699, 0.3720667599803317, 0.32126076352139793, 0.44456712739230736, 0.440659794306504, 0.3243160054607883, 0.422083341266567, 0.45046100930088845, 0.4238484776991399, 0.3649607975278897, 0.31118959066118534]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7874067457529844, 0.8699445326816443, 0.8577893469038914, 1.0, 1.0, 0.8802660585778276, 0.8267541498271689, 0.8052903716385332, 0.8595961684179837, 0.864479310506662, 0.8273014540531353, 0.7644864418777032, 0.829447881050925, 0.8552660143354748, 1.0, 1.0, 0.8529071274552661, 0.7687330385281774, 0.8246736280968149, 0.8331619220389593], [0.19122965622511634, 0.22822318646258574, 0.2916641853354132, 0.30000848687924175, 0.21174778256809984, 0.28800423008297305, 0.23912677867093748, 0.2274286116426057, 0.2572975552589957, 0.24691275129962564, 0.3213048812668642, 0.38123765802327864, 0.26215311482190246, 0.22290738291731013, 0.2926413813222105, 0.23876044220282275, 0.25611464688703395, 0.3078357791108123, 0.2614359262653353, 0.3255257219606922], [0.2680419269967878, 0.3740940928820516, 0.3025206458614655, 0.33786607841460553, 0.3340120587742833, 0.2934111614023705, 0.35383831270331223, 0.2792825050219611, 0.3180147590950773, 0.3140644724617076, 0.35908429717570467, 0.3683164465464467, 0.25394440186359085, 0.33962355146070344, 0.27870309671614246, 0.28774927046995125, 0.3295509993066075, 0.38341378747982086, 0.278661443633697, 0.3490438086221133]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7453989178501236, 1.0, 0.8685785107892776, 0.8642775985244979, 0.7309312186149979, 0.7532535905164575, 0.798617968390002, 1.0, 0.8775592872205782, 0.8865466371890521, 0.8837267335090246, 1.0, 0.9188737818268939, 0.8556135829851083, 0.8260557877859671, 0.9376390891416841, 0.8444983784423141, 1.0, 1.0, 0.8001483733287174], [0.5827280887936245, 0.4814172187252445, 0.4810078987153523, 0.5637776139192083, 0.555991308936543, 0.5508383588340445, 0.5178112584121437, 0.40435072547024353, 0.4891093434478244, 0.4134651142195558, 0.3591431872810797, 0.4159725771721547, 0.4266954468742107, 0.540058621348199, 0.533758791579474, 0.5188479458376476, 0.5648989895198646, 0.4148642666340235, 0.46804239513707624, 0.5035016045520336]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.9185578526491885, 0.910566842453644, 0.8402009621570123, 1.0, 0.8778182440765832, 0.8586418260413438, 0.8363226517062685, 0.8026350518288673, 0.9053098087184154, 0.7633995705343102, 0.8966624271267448, 0.8326723603435697, 0.8592622994251259, 0.8829822977879798, 1.0, 0.9518840165090435, 0.7914631935306128, 0.7052753515579631, 1.0, 0.619675041211837]]])
combi_perf = np.array([[[0.2923608491355539, 0.3061426568219822, 0.32799692694697297, 0.29435063229906416, 0.3344355953916453, 0.3845128838149867, 0.31669257866820644, 0.274950530081822, 0.3254126113981564, 0.2992693597057173, 0.287935000890954, 0.2633821821355863, 0.3881340593457184, 0.3044425333507811, 0.31748961389263664, 0.3497307666340373, 0.2987503490752974, 0.3066420179659775, 0.3465835382996428, 0.33354784959217704], [0.2360897037551928, 0.29517501716344363, 0.24287396517954388, 0.24163456285195692, 0.18543781288896166, 0.26376781731744053, 0.22791263253745733, 0.25775549672160575, 0.2510888414035002, 0.23894161517862367, 0.222963761879196, 0.23125689453356688, 0.22670265143778495, 0.24659796188032568, 0.24926803827669045, 0.24672409566983303, 0.23584591834948346, 0.27784527736093595, 0.24399770687895467, 0.26362362288388247], [0.2692596002246289, 0.2999371583003785, 0.30737673161707735, 0.3077785368356692, 0.2925395110083376, 0.2710465619139124, 0.3410136601654803, 0.28286293300043613, 0.26791098645008904, 0.30640311126328906, 0.3360492477181412, 0.23187377606833842, 0.2963285651981739, 0.257542673863109, 0.3025180909928709, 0.3513492711474268, 0.33652077513592765, 0.3300639176414417, 0.29495273870801286, 0.2893302708585137], [0.24230778401924455, 0.2894760648323866, 0.27543192139736167, 0.22355968611126448, 0.23714930643225718, 0.23314447311152678, 0.25679939217827125, 0.26350022152510216, 0.2636690275629033, 0.2611888624027677, 0.24752018148690008, 0.22731146483620884, 0.25207994523293537, 0.2403890272136731, 0.2459770657807051, 0.2260609632013791, 0.24625960199196795, 0.2772413858137367, 0.21552132440041233, 0.2670246147588718], [0.19841327658650548, 0.19675393840643235, 0.20578618166357726, 0.18526132743893134, 0.2014593252622648, 0.19301488981433088, 0.17233438295125064, 0.20252947502774038, 0.1727472605146306, 0.1751151024897203, 0.17880443697519935, 0.14234529906608376, 0.20334953976562078, 0.1891609242019503, 0.20364165882205593, 0.16620406989339376, 0.15856833867961387, 0.18676728309527535, 0.18452485685061712, 0.200498870503292], [0.26543389427245473, 0.24573022548452997, 0.23228530280412452, 0.2546482662537244, 0.25127284354232116, 0.2514933960525221, 0.22217795254802442, 0.2415849950210825, 0.24838270080409278, 0.25145780567794723, 0.2524979792620679, 0.24959257876103452, 0.27023590700681, 0.23753387388582897, 0.2478703609581216, 0.25703471204604417, 0.24684117593669005, 0.2976673191102132, 0.27973204649470873, 0.25272898496380464], [0.232663777701139, 0.24760108375119622, 0.20531227778442598, 0.23400576703710121, 0.22625040877305785, 0.2867013022799073, 0.21562410999608353, 0.22813419539510185, 0.2105730684254614, 0.257163268694102, 0.22741794660553255, 0.23572452385580825, 0.21638152318652132, 0.22990660626806014, 0.19841711872386708, 0.23347931031702063, 0.22240646592459137, 0.24955147043575093, 0.21183015592250315, 0.225647426849831], [0.2060180174708199, 0.19735417545239803, 0.22804564446833647, 0.23287245250701727, 0.22874256744181243, 0.2622243292654464, 0.23206513061392786, 0.22503090715680724, 0.2236111737840968, 0.2173888056662463, 0.21886751533915905, 0.24201873834384383, 0.2778275820386736, 0.2610352611788946, 0.21902768508143003, 0.26486589573707464, 0.24904715283490983, 0.2842550803985982, 0.22075146970340617, 0.22836047398118253], [0.234139250659411, 0.20550372238206216, 0.2612351438082528, 0.2421362533407686, 0.258476821655782, 0.2586548296350693, 0.23498311673604355, 0.23375452803439736, 0.24468992487853294, 0.23267855248818678, 0.23206578708631947, 0.2522611244586886, 0.2340789252667553, 0.23983424767059336, 0.23848014138604653, 0.24485519465785366, 0.24083573475241676, 0.23650686008951408, 0.22409866479646107, 0.2579143367980514]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.4946207374940058, 0.5157447366870311, 0.48027301202533257, 0.40468985501155463, 0.3921779636703424, 0.4105359790578297, 0.46035022674326853, 0.4832254064312449, 0.4159820380271764, 0.414301423714942, 0.43287901136572365, 0.4812535471126512, 0.4847003617343462, 0.3944737130205377, 0.42628034692051603, 0.4253563334887638, 0.42799646717259204, 0.47004981702369414, 0.4831310660575869, 0.39812744898016517], [0.326498961558758, 0.2703693725847961, 0.26203680699194576, 0.2665842647353332, 0.27519437139477537, 0.28266374990369975, 0.28206178843112967, 0.30988383591566354, 0.26461276455244603, 0.28587809958152627, 0.2977591060787828, 0.3065170964885848, 0.2981316199555964, 0.3053705521896601, 0.3142849320474341, 0.2703292288278446, 0.27458351318634944, 0.3040971321013813, 0.2567034115168444, 0.30093167930364023], [0.34490808180352894, 0.36482698538398745, 0.35637735026018913, 0.342847709778096, 0.3188597999953855, 0.34129714441061093, 0.37199955615622, 0.3571657905394822, 0.32459998544914076, 0.3008960096893416, 0.2743538937712474, 0.3236138043811601, 0.32246496107076267, 0.2600485016589574, 0.29433845728852015, 0.37498468022347187, 0.28631940316708027, 0.37691645889676206, 0.3377422202002368, 0.3633924557166339], [0.2873569770703291, 0.2692867222105793, 0.2732314747182, 0.26300607573111956, 0.25351721665866483, 0.27101629394598237, 0.26908732123596807, 0.26784184720767934, 0.2795698662217925, 0.27567318373768174, 0.24654476643253828, 0.28256481707864506, 0.23877896630134732, 0.25788114196203443, 0.28768432226892826, 0.2995519952850855, 0.2792927303951196, 0.26628446770331027, 0.24437702630388325, 0.3187305257094011], [0.2592090236878643, 0.35373336714517195, 0.2746111479828285, 0.2711985361726092, 0.24935493887505933, 0.26452269340716045, 0.2870835645840496, 0.32243949414947737, 0.2540629925179051, 0.2691088820812069, 0.34188085311426303, 0.26301283766510547, 0.26792404499615174, 0.25463518495709336, 0.29471526357957, 0.26860684641442295, 0.2914966959503122, 0.3533208573282014, 0.2289375351010535, 0.25828838097601703], [0.24244362396356842, 0.25146784873215045, 0.25040643398650597, 0.23371712641022904, 0.24781514710979216, 0.22513201458454815, 0.24738967410352805, 0.26293073026200653, 0.21486784441445494, 0.20655383779637862, 0.19557022728809761, 0.2866416894218841, 0.258722150909084, 0.237455426979686, 0.2392180729948573, 0.25426118698945654, 0.25401455468755313, 0.2630894305944587, 0.26775473061839, 0.26235872923110853], [0.2688897546089711, 0.25714228707613895, 0.2349400789222819, 0.25738190222693297, 0.26057479155654467, 0.253713329166854, 0.21942945001815692, 0.27290771823367926, 0.23263952354100312, 0.24926566224589827, 0.2776851492386092, 0.2361991810486465, 0.20078803136722906, 0.2500497922023652, 0.265917253771511, 0.21350234220196035, 0.2955728563741901, 0.22599551801841367, 0.19405964522375424, 0.28986662978338706], [0.322416391521607, 0.34135455053661634, 0.29753849080855516, 0.23492988905244952, 0.3544352170950908, 0.287805748224866, 0.3202318568886482, 0.3270772855843242, 0.3340806021525745, 0.3224538812128438, 0.2866334032546382, 0.31036786501559976, 0.32725571323256897, 0.32447643446095936, 0.31544738529607774, 0.255701315828826, 0.2771433710660225, 0.3191699114595259, 0.32247047564759, 0.3381414824321573]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.31114511682415097, 0.2574868078264813, 0.28954586648487346, 0.31596627835735336, 0.34752402124255605, 0.33513021837680884, 0.28888569190049745, 0.25070505667160936, 0.2761471933214573, 0.3194421721948649, 0.2603350133488074, 0.24548718041157064, 0.2908541884636922, 0.37674172947703194, 0.3582157018353509, 0.3298519761807029, 0.3285981565470622, 0.30530202433504144, 0.31244742074509146, 0.2958031182076957], [0.26009830506371256, 0.2952908559673812, 0.2650149463471399, 0.2653791513229414, 0.2665803915317739, 0.27013005845272486, 0.2911594669370726, 0.2807348210469423, 0.25162930944607526, 0.2415915658824945, 0.23900375191346437, 0.22335378875899187, 0.2789022245124634, 0.3104655735625853, 0.27520738187423627, 0.3114767931325872, 0.260934509241338, 0.320297525771459, 0.2529502645583204, 0.26302193387651146], [0.16773927367450792, 0.17083096575401555, 0.1662744171104024, 0.16698519867449152, 0.1921764623269231, 0.15826352714059777, 0.16008922587276006, 0.12169701029783588, 0.14885766684507648, 0.15102346282805232, 0.17207832350016497, 0.1333117998811551, 0.15596320746179587, 0.17545447886833052, 0.16325619334673083, 0.15500098747783456, 0.14627528276126245, 0.18856620714347377, 0.1401594257536889, 0.14272136023705362], [0.28945325880868306, 0.29836159042330346, 0.30152332390512193, 0.28464691725446767, 0.29898616141541035, 0.27701818980529225, 0.2901961629748178, 0.2921970534984198, 0.27403417093458116, 0.26853164536421925, 0.2743427884136503, 0.27876092203842356, 0.30052314141326464, 0.2818379829386446, 0.2767650524410207, 0.2817212668702889, 0.29017815964919996, 0.2938466052512333, 0.2849406240035829, 0.2973846203543098], [0.2816333117935458, 0.2608232246638396, 0.2934064646539135, 0.2342189257047965, 0.317822824122779, 0.26218278085121177, 0.28331030845621713, 0.2534896863782319, 0.2672837455324749, 0.2800951513451644, 0.2498751745734434, 0.24810329756450933, 0.2820903126555782, 0.30409288369148024, 0.26287206961333875, 0.2663114143525223, 0.27765995729609133, 0.2693820224774153, 0.27898606881369054, 0.2516099691776654], [0.28540942681016845, 0.2671324431658292, 0.3124869408068201, 0.25706545093132, 0.27320979024870534, 0.27342019194793366, 0.2372780878873728, 0.27353219431961734, 0.2674193619457048, 0.23384979556785443, 0.22059059493107136, 0.2523217438821957, 0.31963129360415415, 0.3235519461793797, 0.2648282534165652, 0.286887501752034, 0.3157987717913935, 0.2702235930443089, 0.25719309792906175, 0.2735872682395787], [0.30497316996727375, 0.290038957856972, 0.3015343573228433, 0.31411070463025703, 0.26795123556906164, 0.2910803619266468, 0.2932118072519279, 0.26383785555774536, 0.27157149902336475, 0.2585158837313197, 0.27982384550321254, 0.29530719819173223, 0.2682277000823362, 0.2595683067926121, 0.30608084177896877, 0.26861558208980535, 0.2812812453613329, 0.29002607291931176, 0.3051577225729915, 0.324255900737081]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.4477265237345893, 0.49730227645187725, 0.4430026389997732, 0.41156276852628965, 0.5297894865489811, 0.43173414104858127, 0.5511047946042964, 0.5301575040111867, 0.5511589341623907, 0.4510313036104517, 0.532961680200712, 0.4219070080756111, 0.5010041664482879, 0.4736409920200758, 0.5225805230939954, 0.4884829197335131, 0.4813129781835874, 0.47294203695977, 0.5136593050918563, 0.5061519176008794], [0.3276050000669246, 0.2835550037853894, 0.2729237825146742, 0.2478568499042857, 0.2749021446083951, 0.27504033468947053, 0.3146782805984154, 0.285779333570631, 0.27951890063372736, 0.29195117657117453, 0.29653347262308627, 0.2741461389494578, 0.24187300701151176, 0.27183482340798076, 0.2848732630974487, 0.24940939921214825, 0.27772930237976984, 0.2930635108158701, 0.31076366231340524, 0.29970467781710874], [0.371711237496828, 0.3631426299846857, 0.29334965587585593, 0.330522728742933, 0.2970889424684391, 0.3278393889618788, 0.30439252647081794, 0.37360604952464554, 0.32904918053957954, 0.3484266377488807, 0.29622381131749165, 0.3057468222727396, 0.3232266908161879, 0.342626485717331, 0.352143509629632, 0.3155052378796713, 0.2938271775358432, 0.35333730715913064, 0.27455385087367223, 0.31585064564326226], [0.28793349429170784, 0.2375439026009303, 0.2499536298204875, 0.24697995037773263, 0.2475556197624242, 0.2857536786227961, 0.25821500203443654, 0.25839243642959164, 0.2830395879567147, 0.2498568452637125, 0.2598773559956704, 0.26701743703394215, 0.2542830131726937, 0.2707990921953075, 0.23726386524902393, 0.29369457671112714, 0.26691324475530964, 0.2788441167880852, 0.2727953700597708, 0.20582933796413858], [0.4001401269943076, 0.2948749536547112, 0.30338374434254034, 0.31222214584372676, 0.3350946653476039, 0.34236864095948955, 0.3807245178552476, 0.37368786949134714, 0.3355769700286146, 0.31000430228126225, 0.2908548466393636, 0.4168779376961473, 0.2979922725661321, 0.3628310505070004, 0.35241427702221234, 0.35951614377878405, 0.3195291097125581, 0.37915393177701906, 0.4037507819642964, 0.387020748318821], [0.33147724341078133, 0.322830621543317, 0.3332914808516477, 0.3308346073382353, 0.386303247845931, 0.3233047778132406, 0.3270907548069784, 0.32948567215231256, 0.37524337956999304, 0.37568567778548934, 0.3124210755778518, 0.2645833167027483, 0.31154238588418964, 0.3527114853464569, 0.35451983442441104, 0.362222108240963, 0.3207377782710572, 0.3498129725113909, 0.3650758411145982, 0.34725487973810043]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.25298549139166104, 0.31436160017690506, 0.2426093593453991, 0.23342598648975693, 0.28143484780107697, 0.2572497246775472, 0.258793427157872, 0.26612283885663457, 0.25019317327832546, 0.26441874506437313, 0.2394039343680772, 0.2351807191202659, 0.20272973512259038, 0.2315163145068521, 0.26442400943249034, 0.27184831196709697, 0.28860838539140937, 0.260823853998141, 0.23070627254789747, 0.29536624833409447], [0.2454459606991781, 0.27521873650016276, 0.26438609433605625, 0.29102277535319593, 0.22547373090153985, 0.2554566440234941, 0.22633791436001852, 0.2784473289778426, 0.24771279437273203, 0.2489587695799314, 0.23791684076408345, 0.28986366700891814, 0.2453658621999868, 0.28243755706021745, 0.2593379252244566, 0.2898636651379465, 0.3006549570698969, 0.24048937966552553, 0.24681599299397805, 0.2990097464337334], [0.27262609162835205, 0.2591121590592993, 0.2592118465689034, 0.25223171345516526, 0.24942988587118495, 0.2532082697516287, 0.27332728494865505, 0.2602940452970105, 0.2678061814990724, 0.24812935523396668, 0.29148037719242453, 0.27923996122345707, 0.2612373479751624, 0.241936573689942, 0.25808719208594794, 0.29630192972627306, 0.2607744065329647, 0.24912992318429458, 0.26678594937370004, 0.2321873440469102], [0.2696214401015905, 0.2776042186015813, 0.18097677540239263, 0.22050808139335695, 0.2795983961490621, 0.268380829579946, 0.2691512432530477, 0.26714724688194413, 0.2704833538611427, 0.2456109474292975, 0.2814277168342466, 0.2739905375255764, 0.26141508593720447, 0.27457732796743334, 0.21104540823591353, 0.28041675203261063, 0.27570129106545926, 0.21064550531070886, 0.22504428346271968, 0.2746879021856069], [0.2685154418744077, 0.26337817540015596, 0.2896647019334881, 0.2599072919163231, 0.2868229632924356, 0.2872171466215049, 0.2808073122668639, 0.2864580614066242, 0.27439426924786625, 0.27633579069242276, 0.29275445531291594, 0.2423576265109257, 0.2448986051146, 0.23762026924261395, 0.2638641106987273, 0.23818103478875172, 0.2791051183995858, 0.3009253226976824, 0.2842687030529085, 0.2671746406265296]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.6198888438848297, 0.5839475603217352, 0.5871961959803423, 0.6875907597593126, 0.5846604891582915, 0.5856831638895776, 0.629111796942752, 0.6359283783026592, 0.665346765741762, 0.6235175415338069, 0.6396463946448786, 0.6621947900504574, 0.6822516658512352, 0.6154850145718318, 0.6289292192312367, 0.6792542219775111, 0.5726990854752293, 0.6155857489263534, 0.6214932455658108, 0.5655336958493672], [0.2959795414337287, 0.26076205522108337, 0.24531812502985278, 0.28337239153556265, 0.2743758548057036, 0.2537561389105206, 0.2495790154660791, 0.2613483872341616, 0.24817124014209552, 0.24248332024904604, 0.28340210381636977, 0.23495734465970433, 0.29257563171236484, 0.23228484877277844, 0.2906661778280107, 0.2628243312539979, 0.27026061418654246, 0.2641278674781623, 0.2702334230039071, 0.2803001203309947], [0.3160980554686663, 0.27569576317311617, 0.2829996124825923, 0.2810358384643958, 0.32227855868240923, 0.27690769720026526, 0.2533572796109303, 0.2844361334172993, 0.24455002940706988, 0.3343317399165353, 0.29298831343556136, 0.30025868121704336, 0.2656517347994144, 0.35311278576195604, 0.3184753552872714, 0.27076022492753493, 0.26592578231071096, 0.33762039180908643, 0.27266320206345945, 0.2638021003046793], [0.29004950013307423, 0.29722286907103806, 0.28927806170548004, 0.32004190474994004, 0.2852256937736592, 0.29845400340758915, 0.29951409046690036, 0.282374645800481, 0.2706191978841668, 0.28568308149786625, 0.30064159352189057, 0.3078334721603905, 0.2878474843134456, 0.27758912282750603, 0.3116913692040781, 0.27780852859683647, 0.2690999402917167, 0.27213124573333686, 0.31574180603092833, 0.2632469119342903]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.38049290523431906, 0.39334067622349944, 0.3465430395819057, 0.3621801523280619, 0.37287665104438444, 0.34461354971568037, 0.3617538834257203, 0.39471164950972604, 0.3576926386476911, 0.3836034477672048, 0.3663603861309791, 0.3754338702367972, 0.3936112158420542, 0.3697595236183596, 0.3526505881658627, 0.31245334895457905, 0.3344293746755054, 0.3563059566733429, 0.3331647074671081, 0.39256029966158595], [0.25191333587336706, 0.2717641968522632, 0.2965088382169008, 0.2835094930702943, 0.26469398343114403, 0.28888277876865015, 0.2903562102113604, 0.2711964328366334, 0.3168015656537414, 0.2598868889092924, 0.2787569703640306, 0.26839973726829164, 0.27533642686468185, 0.25860688833112, 0.2498757787924167, 0.26161859064411735, 0.26643067264436787, 0.27905558915764694, 0.253591958837385, 0.27958704692408926], [0.22049690774510386, 0.2402116996706615, 0.25266325762296965, 0.23668807158762442, 0.23601844667027236, 0.23963814669855704, 0.23050514936548117, 0.23737028449663977, 0.2598135978802865, 0.20369937078116895, 0.2061024503995803, 0.2047939901189946, 0.21200172284811425, 0.2772064959498875, 0.24459434456161636, 0.23668545731439325, 0.26191315713397345, 0.2500746707698765, 0.2305547449786381, 0.2683364387179712]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.42089556153121016, 0.4629422049034572, 0.40412169065444786, 0.4884922661362916, 0.5397812916540248, 0.5054652023177156, 0.4488180681041594, 0.4809873877899241, 0.4982643016335912, 0.45359620707569676, 0.5284020539810889, 0.43598790170886864, 0.4648293671438341, 0.4994298070165162, 0.4777257699554851, 0.5139977771596145, 0.45563385128835543, 0.44924334086148776, 0.39176400407155126, 0.4531325286927911], [0.27372630522930974, 0.268209513130517, 0.29766491904016, 0.23664785390693882, 0.274274877932754, 0.23045555992964334, 0.2971729585715952, 0.28794652864922826, 0.24473535438364225, 0.21094554227825257, 0.22626943925358978, 0.26541527618446353, 0.2380303725334448, 0.28692132614455745, 0.24487061057390633, 0.27485041485750494, 0.2682468408580931, 0.2767978784290144, 0.20685420568531693, 0.21603842640601015]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.534054459266668, 0.5281738075188068, 0.5599122134189969, 0.46400340817047875, 0.560521154650052, 0.5559828789338509, 0.5369442536757878, 0.5477392934630594, 0.4448657552548762, 0.47743105480400916, 0.5008069881610622, 0.571816053429135, 0.5784555546328959, 0.4847499851237899, 0.5893098212721364, 0.5407732573934999, 0.42474954569526124, 0.565929529401342, 0.5704386629301182, 0.561694991764903]]])
combi_perf15= np.array([[[0.30013347122318534, 0.27326082864903767, 0.28652392881901, 0.3218122031811096, 0.30868954081478067, 0.3182788314825514, 0.2779149474967577, 0.28672839315858656, 0.3226346734632694, 0.2881537994528444, 0.2490187937599836, 0.2653043688550561, 0.34758019535434076, 0.276127294855506, 0.29389132987390065, 0.3040477896218425, 0.3008719606092125, 0.28789903423825886, 0.33891011065055515, 0.2928432971350756], [0.30785461653113727, 0.3112428362870226, 0.3095365732960867, 0.3264071435384373, 0.2816337921029882, 0.2996900928009731, 0.29115033526925177, 0.2773615943907043, 0.2957479748754293, 0.2968829559593172, 0.3040904175347113, 0.2997075221878284, 0.3096888162688041, 0.2692532430071535, 0.26438714304462574, 0.30008151443982706, 0.33037007095340076, 0.31331407243430043, 0.2915309730184726, 0.29009194480850936], [0.2171052002284903, 0.2347678382882002, 0.2670555015331401, 0.23216333774132833, 0.27974359689703937, 0.25677284272618894, 0.2215861724709326, 0.21398515317316, 0.21295293877849678, 0.20835135641975983, 0.2542681479575985, 0.21147959831615795, 0.27922336141204074, 0.2218708513751358, 0.24781647046119645, 0.24456291624226634, 0.2975253357972163, 0.24424215940323551, 0.25726357033657543, 0.2322108376549934], [0.2882487734586971, 0.27913654709903535, 0.28019675160631685, 0.2876725752821651, 0.2906647473282128, 0.2928343368725248, 0.29685115013565894, 0.31374442031813626, 0.2695505855767784, 0.3331460710865674, 0.30171255510079875, 0.28311371321467316, 0.30410259524102157, 0.3079306809393598, 0.28841921290998573, 0.333184636299754, 0.29378984276256004, 0.28928919211216536, 0.2876749275905722, 0.27674550221056193], [0.17327129685655698, 0.1625748603484262, 0.15684418885790816, 0.16575303591734547, 0.18361638231583496, 0.16818864137082445, 0.15814803965744625, 0.16525322146454063, 0.17236031168055718, 0.15737726026227403, 0.16266653711404097, 0.1618045500729369, 0.17240940441656064, 0.16493979686952717, 0.15562482083220466, 0.16060506134144864, 0.14975809028168277, 0.15720454028010197, 0.172258249760083, 0.17089397559592706], [0.3254105719349532, 0.30791595951568884, 0.34048739940404477, 0.347216217424621, 0.33369814765637135, 0.3378342107925576, 0.32298631108167336, 0.3293158319917923, 0.319005577339503, 0.350206237673723, 0.3089750055089764, 0.32976342898363425, 0.3522870134193379, 0.3211941909794654, 0.31063686403809165, 0.35040190414050104, 0.32969710649571565, 0.33597504224057684, 0.3107325099180874, 0.3404080588425227], [0.28256092482184086, 0.2588690508907148, 0.2758988787807004, 0.3454605206258499, 0.25958079767822906, 0.31138324411229135, 0.31190716596933576, 0.2528319406464623, 0.29245982727170833, 0.30578874215264173, 0.28790980331649774, 0.27613703998453304, 0.2820673976227074, 0.2408988750972817, 0.2733341415169464, 0.26804398854724654, 0.29421071399504783, 0.2830039482912514, 0.2697186808648473, 0.2686600158747103], [0.31695681789876917, 0.3138262240140317, 0.3131786207918616, 0.3079542504427699, 0.31138549153002004, 0.30430678505015785, 0.2961435259201152, 0.307308362789901, 0.292899524050347, 0.312934400929529, 0.29223674895144014, 0.29058683842220356, 0.31710966636758614, 0.29493023301713106, 0.3008960901000171, 0.3144480408005959, 0.27724980884460415, 0.3110422190203052, 0.3081367718165496, 0.33301593232113363], [0.3053878487165278, 0.31038946738873774, 0.3234813110509029, 0.29847944863103115, 0.3048034037768962, 0.30942852853276975, 0.31482628095809195, 0.30234956410103603, 0.28627787853328, 0.31114950812426667, 0.3184461540452855, 0.31085033561876296, 0.3265296378687322, 0.3004440077979404, 0.31058423365041116, 0.2975374183357962, 0.32130615271503715, 0.28490766367038634, 0.3101309606515391, 0.34345886357808325]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.44323579311566497, 0.4503960530223838, 0.43525299242266446, 0.4279897601549379, 0.4500062974541989, 0.4842577767993127, 0.5659783471620378, 0.46834155521578846, 0.44843985190564895, 0.47155431665827974, 0.5511813055432315, 0.4538435017485834, 0.5111459073185125, 0.5271647711900777, 0.4740454026652326, 0.5575383306491982, 0.4580213342034818, 0.47119626519726626, 0.42850540250492014, 0.479609742127417], [0.35631279699458646, 0.34108538602093924, 0.36138107583640716, 0.31826869244078665, 0.3569589366581403, 0.34158888862506326, 0.3473832142984782, 0.3522329035596489, 0.33323507225383614, 0.3197366014493054, 0.3547857329938306, 0.3132633084106806, 0.3548368098169056, 0.35742102128252684, 0.35651847878072834, 0.3712176826288181, 0.34356012750848053, 0.32688489581893626, 0.36793266553170917, 0.32962688244400407], [0.3681892330179248, 0.34358655203755767, 0.33476606562939054, 0.33206188768895184, 0.3503243032561988, 0.34174712879860636, 0.4397887855741726, 0.37524018685281874, 0.34895354240352616, 0.3378663955532413, 0.352101132940975, 0.3666095500386549, 0.4241953862050824, 0.34864837479716526, 0.41644235586064576, 0.36122595192984386, 0.32612755400355364, 0.35975625918597437, 0.3163033791456421, 0.3427874464391298], [0.3018158917174916, 0.2849917864496006, 0.32221683696708203, 0.3073509825267349, 0.34109614707937974, 0.3137843681070765, 0.322814534889383, 0.3027148464719399, 0.3104141241414804, 0.3159428504860957, 0.3143307578132238, 0.3089700876122556, 0.3173338914020802, 0.3059594278208289, 0.30996108448847565, 0.3102191726164064, 0.32659926238331755, 0.27997332416903997, 0.3069082721895009, 0.30943575350016683], [0.366165934451938, 0.38566372036136737, 0.37002089418388867, 0.38513637528205963, 0.3416397085513064, 0.33889395321902666, 0.3771031436187899, 0.38239137606735063, 0.3661984006790561, 0.364918412873522, 0.3764425606546258, 0.3827409214040938, 0.37918746146391163, 0.3441429321569287, 0.3782480629599399, 0.3756981430461985, 0.3505896918351808, 0.36541077373092257, 0.37200431157223274, 0.3623194669821104], [0.2902117983302497, 0.2988574263167785, 0.2976721086804336, 0.28142517328795025, 0.2816761989873353, 0.28436587604657276, 0.2923851588906368, 0.3021863978200519, 0.3051260119597584, 0.305609637715724, 0.28187181132618727, 0.30210469809255197, 0.3070335961585346, 0.32221162334591935, 0.2895033334191121, 0.2721058630317646, 0.2830031444784917, 0.3417154113283931, 0.27871522312087815, 0.29540419244957233], [0.3211322104740782, 0.31542230611955197, 0.3233642775152798, 0.31396968231719125, 0.31926889796565544, 0.3208620652189169, 0.3024127597395881, 0.32031003162189053, 0.2907508270985103, 0.2979545837395644, 0.28099339381521526, 0.30307171672031785, 0.3058442997368557, 0.3069344020030564, 0.2991967848356979, 0.3155310098374407, 0.32068771314102174, 0.29333450562243835, 0.3038191053989675, 0.29395245405954706], [0.3584291973581568, 0.3043516046972969, 0.33715485699238057, 0.3315602120115162, 0.38243995315478696, 0.3053335989983376, 0.3368150450627329, 0.31166795794160695, 0.28939176610851064, 0.32207927107934076, 0.33318077739369534, 0.3147748748831144, 0.30830345321790487, 0.3240575602350989, 0.3431720315326334, 0.3159913297211327, 0.29945063014330303, 0.33717765078983386, 0.3291456948595469, 0.32648711358711835]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.26625821236568187, 0.23645226584762072, 0.3147360294373282, 0.2776190165553336, 0.31827544325019996, 0.28372114024293754, 0.26642641935198846, 0.2344221052859805, 0.25204429879661056, 0.26746705927448755, 0.2726334986762705, 0.2303270941716656, 0.25430245597758905, 0.2728333328054953, 0.2533757045369102, 0.255822628559009, 0.26966181328889083, 0.2645750878437442, 0.3074584184853077, 0.23938775867168588], [0.34450156297964657, 0.33269332990038275, 0.34720642624698933, 0.3391339134083548, 0.31582087428914113, 0.32386272885974343, 0.3403889142757586, 0.35821755762742835, 0.3230144172826848, 0.36838959799208776, 0.3316906596463881, 0.3399964335697188, 0.32291786477705764, 0.3381363076777715, 0.334894470411488, 0.294856022489536, 0.32559479609180847, 0.32349571400547644, 0.34994981302075245, 0.30398640509900426], [0.15180469136244967, 0.13871048834077984, 0.14465061199640125, 0.14431357548119247, 0.13707609549012095, 0.1445605830159208, 0.15358036817067133, 0.13646601692116717, 0.14527771245530338, 0.14232877044510195, 0.13237197168673404, 0.1180292879918063, 0.15552112846339528, 0.15458489258831018, 0.14763231021478224, 0.1333231803312061, 0.1425189750408832, 0.14927623656780414, 0.1344183079618525, 0.1418967240827929], [0.3582893309671393, 0.36034028505028565, 0.3617059925251591, 0.3562506753213273, 0.3653437677128368, 0.3746466668607716, 0.3392716723728872, 0.36199726993091486, 0.37383674954870183, 0.3670016332940054, 0.34419660546828695, 0.34665523093428635, 0.3904105005522248, 0.349120288841104, 0.37365904906005004, 0.3580005104713637, 0.36167064450616837, 0.3692074480593125, 0.35548191723950884, 0.37572244788802606], [0.3491043461305065, 0.35318825587203456, 0.3099158729025016, 0.2931923607191855, 0.2998890322466461, 0.31681900744858815, 0.35450069297961845, 0.34163460547043967, 0.31254886842773294, 0.29843669108506377, 0.3448715787979008, 0.30895999068698593, 0.32483068585455305, 0.3238692009500264, 0.34431073994977823, 0.31466628274254926, 0.28450119340603275, 0.29416542026659814, 0.3251276314502234, 0.31440233447937604], [0.3454580139994151, 0.3425619083254763, 0.3478281508339991, 0.3323006115186492, 0.3543263050009361, 0.3755316536350714, 0.32860062248062244, 0.35383190051825214, 0.338062772349515, 0.3379180214503919, 0.3055753691832535, 0.33409548905473463, 0.3761468566958739, 0.3473039333611751, 0.35227653383201485, 0.3438988800639543, 0.3513303619430421, 0.34204237809756505, 0.3507063273435786, 0.3741713637481848], [0.349493361303967, 0.3774381452349871, 0.38784319651490945, 0.3457853618133293, 0.35135432507397424, 0.3653415804221913, 0.3403271190786749, 0.320387131362388, 0.36377457253977785, 0.33543940550309714, 0.3453524079826644, 0.34344324277321653, 0.3727895962790643, 0.3466085650518654, 0.37184920334154975, 0.3516137502691252, 0.36725604675456847, 0.36633556182715554, 0.36491821093558274, 0.3469070332791024]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.5208515929116974, 0.5227272295377887, 0.5046551948059139, 0.5127975902311578, 0.579862872891483, 0.49268129254514, 0.535120794545656, 0.5316974759344344, 0.4823067571312224, 0.540063132248787, 0.5306389241911449, 0.47216088442731396, 0.5149612606140576, 0.5647926457163436, 0.5274560461230189, 0.45918414631507426, 0.556759415056037, 0.5247157239731793, 0.5561221035619003, 0.4782781520561968], [0.3225055849541158, 0.31670473440673713, 0.328192658855672, 0.3156869933604558, 0.32840065306144456, 0.3110029712242059, 0.3264431194340305, 0.2866913320416619, 0.29532292973627683, 0.31200315715477717, 0.3330570251932214, 0.2843927008517369, 0.3208883326842664, 0.3061384500598691, 0.3035271882706629, 0.32540506096940935, 0.31316003719831254, 0.3185969256660619, 0.326963692417269, 0.3126859924716491], [0.42228359178255015, 0.3783824359464907, 0.39201545815184435, 0.4199689559732553, 0.39804034013921763, 0.404240176229235, 0.40821456095182, 0.4027696949351142, 0.39384038990949116, 0.41709962020052066, 0.41077238514485054, 0.40700597620216655, 0.4158284909665581, 0.3994070818860647, 0.40896211961048323, 0.42153151679882095, 0.3884703899790487, 0.42272920487837856, 0.38537709651524477, 0.40974050447264887], [0.338986226578061, 0.34333788074744576, 0.3338028708550083, 0.3173089430331519, 0.3357816008912138, 0.362470210339315, 0.36460476003102466, 0.35396549013674206, 0.3418234924523051, 0.32508469391556644, 0.3445735756655045, 0.3194389357653856, 0.31890389237966377, 0.3417864681129556, 0.33568304893659334, 0.32906533119548553, 0.32609635396895487, 0.3729304655013756, 0.34153391840029246, 0.33229545612089434], [0.40083503002437787, 0.341606510884651, 0.3306453798500678, 0.36303211766812876, 0.3579726913989825, 0.35522398325104143, 0.3725449101606843, 0.3434732828619161, 0.37813017512761743, 0.3629768868207193, 0.36493705541986604, 0.33801222084133314, 0.3952466415612615, 0.37182004256790085, 0.37032906169410457, 0.34860798238610274, 0.35307866779833236, 0.3848997021602612, 0.38065882769688597, 0.3672321422266576], [0.38314618628040065, 0.3554591261717814, 0.36310696560457023, 0.3451754479235615, 0.3758614977584979, 0.3640750414829714, 0.3906021746735253, 0.35542946714571483, 0.3582944095625063, 0.39195282678533827, 0.3557536854479158, 0.31883767096292986, 0.33571578371151567, 0.34499271467794623, 0.3957800151757863, 0.3593481913016884, 0.3506754335760585, 0.3640631180781073, 0.3392938564418985, 0.39638815122048604]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.23037480723783751, 0.23393449196070276, 0.2567649691263751, 0.21366971196620557, 0.25845571164290126, 0.2506042324729457, 0.24958122499963098, 0.2534845946999897, 0.1976367079280242, 0.24545539532044994, 0.2575719281260095, 0.24031891344386397, 0.2288526546815184, 0.2561838767011487, 0.22822933680758034, 0.25540857965737007, 0.25184211121775585, 0.20737435953274327, 0.23956558382286655, 0.243590750695321], [0.34708085484240864, 0.37713190604500807, 0.325464483091004, 0.34399463848584, 0.3157897016135725, 0.35044751877944486, 0.345782978650868, 0.33791699377078066, 0.3332184419969328, 0.34183208598008574, 0.3476626550340227, 0.36846645655629445, 0.3560810200389108, 0.3432418905661502, 0.3409556483233883, 0.35747240163320987, 0.33773764690540165, 0.3538437006415664, 0.3448181983468134, 0.3645500640119714], [0.3012096880556935, 0.2847935815226657, 0.2974993903084888, 0.2924428688522671, 0.3084606732572161, 0.2924913313904802, 0.331871893196266, 0.2809705041920565, 0.2836864491741788, 0.2859071242868785, 0.3196859063257432, 0.28312151921953943, 0.3062706228252088, 0.30997906568323447, 0.296270144929081, 0.3169317720900766, 0.3183266637729481, 0.29409819299051726, 0.2828637487216035, 0.31874779715954293], [0.34269110095345884, 0.33505642083615184, 0.3018966743564815, 0.2783589099616172, 0.32898580582116693, 0.30591399026033145, 0.2894662393719045, 0.3197879984197687, 0.2998730448535821, 0.29561942730594215, 0.31852775504934366, 0.3259205612468569, 0.30437084435574857, 0.32066083275474333, 0.3210884838148525, 0.3246935221672493, 0.294759630824333, 0.2958734809800669, 0.3120423387867573, 0.3168815558529273], [0.3454267526560394, 0.3213860749832315, 0.3405114981067994, 0.3153431831361785, 0.3228501201827993, 0.32399687917095193, 0.33655983646112825, 0.33900426512896065, 0.3131906821186759, 0.3121493150329021, 0.3485684020537546, 0.32258975065028916, 0.35104180873158947, 0.3407544800859245, 0.3455166507749842, 0.33010971607891, 0.3354213201184326, 0.3236739751501623, 0.3380068898585318, 0.35780472749301706]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7239976612085908, 0.615271048498521, 0.6560879641212433, 0.6955387821952814, 0.6826637019061436, 0.6850908558908436, 0.6290675117458902, 0.7224455132286641, 0.6581780770280922, 0.6633774038496688, 0.55064612585769, 0.7094953210248391, 0.5450220098096743, 0.6677684231276929, 0.5421052251669797, 0.7091899098959734, 0.654730632689388, 0.7240820980501823, 0.6928876754692043, 0.674347880650012], [0.37913233923175815, 0.3449068535766431, 0.35534131383551915, 0.36907263041455757, 0.3569130308188539, 0.38114954478302454, 0.3666126600218011, 0.3603553510586046, 0.36377883377640735, 0.3425643501802289, 0.34936953450087016, 0.3472068094509667, 0.37815860005680446, 0.370383127985049, 0.3480553914313587, 0.3788116485995491, 0.345841662695601, 0.37271083825204415, 0.34207965404717156, 0.36250456257856256], [0.39650434085600167, 0.357153518125526, 0.3838316059201318, 0.4082464150949993, 0.38369117839147826, 0.37132215959167175, 0.37278691654202356, 0.3711133218237186, 0.3967142480646777, 0.3848165660953828, 0.39075601161771834, 0.39054715077555396, 0.3873779660194943, 0.3915623862347306, 0.39452580708526874, 0.3828134172518586, 0.371458859123094, 0.3808144817175995, 0.3784879657536606, 0.38498382294824685], [0.34549720372480197, 0.3486263971543076, 0.3339842281642342, 0.3746427214163869, 0.34751583492983695, 0.3363271438999552, 0.34613575004743324, 0.3644424033688006, 0.34675799293493204, 0.37908819064701604, 0.3777660661749623, 0.349978577304578, 0.37691443632626404, 0.3348109212454243, 0.3653542730779463, 0.34745550760780863, 0.34471530098888026, 0.3655688597080035, 0.35301020425335305, 0.3614654194586638]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.40615344300038564, 0.38589037111896124, 0.3859073430567491, 0.39234213522081685, 0.4102006128720079, 0.41750401509367274, 0.4120089552117253, 0.39680110579506617, 0.3929194201645898, 0.40117427046273785, 0.42333217918731764, 0.40563405933561497, 0.3868658187695179, 0.3612493525948894, 0.384235639311273, 0.35034369312958585, 0.37014457141840174, 0.4375893740445555, 0.39469430012947965, 0.39740754219335933], [0.329080957973447, 0.33544606995539705, 0.3458527173636796, 0.33196533550730667, 0.35026749745235486, 0.34657859827961884, 0.34145600405257215, 0.33022108812507694, 0.3552122514572882, 0.31113867478658885, 0.33479617144372054, 0.35232134360430406, 0.3648671902045472, 0.3371947306002403, 0.323723910570209, 0.33924702457004013, 0.33189640563914585, 0.3362488378512037, 0.3206008305534016, 0.3350349969543908], [0.3361337530561809, 0.3212562334088296, 0.33387794456795333, 0.31484865577303817, 0.3272851485593119, 0.31035144870928444, 0.3100863917415192, 0.29904841970999474, 0.32963996622711883, 0.29750730398766123, 0.3204346266158032, 0.3165586803484607, 0.34182025609197714, 0.3118995477920896, 0.3138149681025054, 0.3175902967329277, 0.3229970451010327, 0.3402450672697764, 0.3196537958987146, 0.32049358807909367]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.5559175104285998, 0.498928132369342, 0.4109317068399771, 0.5301050375411754, 0.6005454748091269, 0.4963716983307625, 0.541508293565428, 0.5128891606250684, 0.5421499814957232, 0.48335755709211525, 0.5274021602200727, 0.5739096681683801, 0.5508886528053063, 0.5352426418890569, 0.5285591157007395, 0.5128548071835517, 0.48986756861100156, 0.5354382352510476, 0.5370348541380326, 0.528502531888329], [0.34165814192736843, 0.31858137697313477, 0.3336676586547255, 0.3054395521558382, 0.33410307218536817, 0.30497517784573447, 0.3125837589491661, 0.3079080844363532, 0.3212464664659627, 0.27484048608189593, 0.327157168827075, 0.3229137596836801, 0.30246438824054594, 0.38873595457551774, 0.3575906360329478, 0.3424401304077196, 0.3002349065947755, 0.3381787267967716, 0.300296348436431, 0.3183250365045036]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.6037751989351908, 0.6098638772418944, 0.6080041568875666, 0.5485828758365346, 0.5888441557946166, 0.5692431133285504, 0.6040338048440488, 0.5583653681631849, 0.5152497118588952, 0.616008556456731, 0.6241172871422521, 0.592854108366308, 0.5881342003341596, 0.5907675612812295, 0.5756511290595439, 0.6043328934466632, 0.6250269698202231, 0.6229520403991065, 0.6192509503134063, 0.6201458385162592]]])
sim_diag = np.array([[[0.7342772813024877, 0.7623942801547102, 0.6816369642887508, 0.7033396015829477, 0.6637791639281283, 0.6644260711716049, 0.7757441517192621, 0.7224814380100887, 0.7065486326392337, 0.6882471658199062, 0.7085825735352331, 0.7341358228676831, 0.6557487528600457, 0.7693972142539711, 0.69742143347811, 0.7107796257025907, 0.7038482259247555, 0.773435287728906, 0.7304734072503793, 0.7064236203276719], [0.220193461485963, 0.16859651870724882, 0.3395692421915191, 0.1328057650651663, 0.16672052140483207, 0.3360300323355583, 0.24395844576347483, 0.11281674446018133, 0.29762768229988845, 0.1554006202564755, 0.11989746549137732, 0.21262383140098376, 0.28580128567298696, 0.0908816263976133, 0.17093318049050477, 0.24019890463869056, 0.10729426053103713, 0.21265762827358015, 0.19211699854593992, 0.2871986413070256], [0.6290273279334763, 0.559372923161304, 0.6112303569319594, 0.6377685956867487, 0.5862603282616994, 0.5800428528875222, 0.5783284242017247, 0.5630935998544281, 0.5677503437234841, 0.6286235852887231, 0.5594354531943786, 0.5908499078429045, 0.6191665666964703, 0.6275750821410351, 0.5955532084116779, 0.5217266688719061, 0.5452283615534905, 0.6339693406973933, 0.5322743136376505, 0.6308118459602527], [0.018389580704810837, 0.08043145934627141, 0.148973599880794, 0.19195280655130423, 0.2573984544678637, 0.22343532618780781, 0.13390573503836958, 0.28402581662900905, 0.09052042769625224, 0.09027966565589274, 0.15362822774836865, 0.21421227004220206, 0.1944649539309479, 0.23596717214193386, 0.14249412681457257, 0.0021028587748752737, 0.11878296112564037, 0.0548820725374655, 0.11298934030842005, 0.20848940464361912], [0.2040963199520478, 0.25716186741355646, 0.28387939488455516, 0.2145488103476923, 0.2327472645053417, 0.21861348099388694, 0.27717099954731916, 0.23946876225714647, 0.2247799004029595, 0.22915814905470708, 0.2307993678286808, 0.24522649413484016, 0.1941533092374452, 0.24099028895150515, 0.24907697639100826, 0.24182133674154735, 0.25683797225833843, 0.24673838920311714, 0.31660170141499916, 0.2515761240894167], [0.21210501585383623, 0.1565073228874551, 0.29794378003711414, 0.1661578803316108, 0.1684249559050153, 0.1533139186880713, 0.18190636220894146, 0.16615861877264085, 0.24608253066262875, 0.2598409771610603, 0.03382184082218631, 0.3085778617385404, 0.2635211997860243, 0.3167723961408106, 0.1466994793129567, 0.16272622790907676, 0.156114662896671, 0.11121767245543758, 0.14426635440421381, 0.2196878268030852], [0.1017629141888034, 0.17782763611112762, 0.22334244655899677, 0.05629441550219167, 0.2263984756075794, 0.22173506711987814, 0.290564695430104, 0.2730807714704158, 0.23181148788606015, 0.1806369420131925, 0.28494418859686754, 0.20153240956974675, 0.3216376800862149, 0.2010340541192524, 0.1158665512781636, 0.15571837832642627, 0.10531936793013065, 0.23996746131199018, 0.3251037890321542, 0.21803451701194912], [0.18534834105252254, 0.1735167362607095, 0.2363208064337647, 0.06233505120180245, 0.06188596959143045, 0.24491697866798381, 0.17062132494559865, 0.2204947784378498, 0.14348845668268242, 0.041503541273373794, 0.19499641526643538, 0.22846543980580655, 0.2561370965381155, 0.09037364170283319, 0.24279432271405024, 0.2133411297283916, 0.17957804145494874, 0.18079723870710082, 0.06630918280307661, 0.06823941721565968], [0.12970836819128143, 0.24523575059949312, 0.28396038279300795, 0.04871044798602549, 0.18625239536810495, 0.13281420810007155, 0.20374485533603212, 0.18329112248276777, 0.10668104203228168, 0.16026299223083182, 0.18165362905716173, 0.31993919827434647, 0.31819477050104944, 0.3776386443014539, 0.15940250409399093, 0.09901048431118276, 0.26960847074134403, 0.1760289251394293, 0.014701952774196283, 0.12197691121551499]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.8224998416679492, 0.8102100322593995, 0.82098745843457, 0.7347037540327284, 0.7490531513818178, 0.7493969717815573, 0.7988822668076665, 0.874258287670135, 0.8208005358442713, 0.7891015726328017, 0.7792080060689368, 0.8182656309121146, 0.8708480999627816, 0.8478230406446207, 0.7345883450054129, 0.8422117347462877, 0.8727557846193931, 0.8482652799318661, 0.8394231821609596, 0.815564074309969], [0.24459244669474708, 0.2244612026825141, 0.069568258201516, 0.16232283098122594, 0.185372940032493, 0.14965817154016223, 0.3242362188368854, 0.18390949600087073, 0.12584601758769587, 0.10617135792504853, 0.1266180260294785, 0.14024874761197453, 0.08079786221523286, 0.21908832197127043, 0.3098496620283612, 0.10001716951949337, 0.2545662737679702, 0.1854503147118171, 0.07695041601300039, 0.2138756691380443], [0.16674966670978436, 0.1898261282068969, 0.1969441078491479, 0.17349117224667843, 0.07961025435531913, 0.12787095902288084, 0.22750637503386378, 0.13887749892501647, 0.22049691285933035, 0.14936176997741024, 0.18017381705866253, 0.14423597074941147, 0.27635373862246787, 0.1802295111952927, 0.24640068107651464, 0.1357894177267004, 0.26458877801839764, 0.08379328870701122, 0.1649061667068909, 0.1818474974311904], [0.2884741843733015, 0.19718495626531143, 0.4023353598647313, 0.18064987289314421, 0.20035426670649234, 0.12165662098904625, 0.2332736250079797, 0.28910713971187724, 0.1593376659096505, 0.17109455545414362, 0.2443542447093718, 0.17285757649266767, 0.16782547844015636, 0.20690654181132606, 0.16355035740334695, 0.3964098977494222, 0.30980030882622395, 0.20208255492289096, 0.23611036599453397, 0.1759994090538161], [0.41628395530912937, 0.46121876584702015, 0.3968426058663663, 0.4549996503862691, 0.4613478662553457, 0.38199408347176805, 0.33718600157622836, 0.481971035918784, 0.42912130281659816, 0.44391065842618455, 0.4247648720324259, 0.34335550553776517, 0.45687360299446417, 0.4080336932206139, 0.4515319259365459, 0.36706921794707553, 0.47232666941798357, 0.5146857272852772, 0.32565413027100293, 0.3915134920892578], [0.40002258705112437, 0.4911115758748645, 0.3513581511764978, 0.44482907493915264, 0.4152656226247277, 0.399299323238893, 0.4121764449908147, 0.3547991314208237, 0.3569004982595447, 0.4192153201109839, 0.45759167706278947, 0.46234790625526784, 0.3793930199408312, 0.4065819761642265, 0.45594475617289804, 0.3967798637909556, 0.4393252978327753, 0.3703681183961977, 0.41038235793842137, 0.41640405313700385], [0.4889108399955372, 0.4510556792490153, 0.501602459053721, 0.5167291695731907, 0.5437308426051962, 0.49432783789335455, 0.43057439253008417, 0.5096689045893271, 0.4263622564274698, 0.4505370804943309, 0.482385441972599, 0.5041549644115852, 0.48568966606445424, 0.45588678765859336, 0.42111537070059923, 0.49326629135887745, 0.41874172729219833, 0.4565716629126159, 0.5157289552459817, 0.4179340404783604], [0.5098143253788542, 0.5396265560541281, 0.4872134103137257, 0.4485215004209689, 0.5145459075331345, 0.5822129124231982, 0.534754165513649, 0.5562877144282048, 0.5237961237820936, 0.5004398920341697, 0.49243040283516737, 0.46350931363684883, 0.5792463318060679, 0.554970824449512, 0.4921755631183656, 0.544552252902153, 0.5068754489364884, 0.4915831799927508, 0.5122686625913263, 0.5948492281566301]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.6976048791968744, 0.7193089853786174, 0.6906922147486565, 0.7089857034365673, 0.6986447437065978, 0.7114796881474202, 0.6896637295948523, 0.6887463102262007, 0.6635688571207385, 0.6859449655375676, 0.7064816899755769, 0.7006501126485006, 0.726623044921207, 0.7039322749515442, 0.6810292682753714, 0.6884734311417856, 0.7094903777838794, 0.7645739909241941, 0.692444342563046, 0.6593825010509525], [0.09936975972290298, 0.21773442786789826, 0.2814536349322048, 0.025245460216718255, 0.1256473029096097, -3.705615788821837e-05, -0.007055484347740302, 0.10069293952211607, 0.15754245940902278, 0.1013976127036636, 0.11738983825415132, 0.13129226906059838, 0.1943696711735021, 0.06327222828472137, 0.18048209681978147, 0.18837425360720966, 0.16336615851835143, 0.13651827214220674, 0.13701694623511296, 0.07684761651550838], [0.33203158836303365, 0.3813227349221484, 0.3135697679026655, 0.3421060766660985, 0.314049522243211, 0.33135224150810455, 0.3614042673739745, 0.33094440809767145, 0.3054717607805597, 0.36629683382236705, 0.3293230126829063, 0.34510332445639363, 0.3026656320759453, 0.2971503983402235, 0.336663703648793, 0.37548925370150554, 0.33907919269159836, 0.28204291322977354, 0.4372374223517315, 0.32262701526093657], [0.1797192917287724, 0.14416478222089743, 0.2324730030192898, 0.12265913142239808, 0.12267784599268296, 0.2061014584306206, 0.10822043377232422, 0.31392323161740576, 0.06362852394527506, 0.16265201706799254, 0.00340012461158564, 0.06247047105754007, 0.11911199672217126, 0.07292618376093299, 0.11991557991100603, 0.07258794526441843, 0.1674290805101099, 0.17086052481489833, 0.15623757034805918, 0.15541631298478756], [0.18429428226910524, 0.18122137398832328, 0.24185102016558602, 0.10222406106250416, 0.12248025723722858, 0.15114850583701728, 0.2151899037022744, 0.07536722035338819, 0.03865116817988425, 0.04577652083083929, 0.11345585788546869, 0.1421738127772004, 0.15922308558256104, 0.08638238012795975, 0.13144584219429645, 0.10653476599828707, 0.14131562285227037, 0.1316115977567408, 0.31687016273383534, 0.11641920053997566], [0.17659117518866144, 0.08371910279850775, 0.2765612034046618, 0.14446342023386816, 0.12471273980899532, 0.23114731057821217, 0.12118062860475327, 0.03992017793487378, 0.10490865471904198, 0.1522405640528095, 0.09713303796326508, 0.11557389991460026, 0.06520797526991708, 0.1372088475599489, 0.029900945397207838, 0.16849108402427934, 0.008428136633781806, 0.10418455857249335, 0.11755472680934212, 0.1668275839004425], [0.10326718203843262, 0.16868137799592908, 0.3585943373242347, 0.268726946445809, 0.1648584458592685, 0.03257148120070201, 0.2501558862018304, 0.1386595796782439, 0.16316036561147512, 0.1219341539348469, 0.266187074195035, 0.19031505196679802, 0.3148204543600476, 0.04372906819595318, 0.26119810666150645, 0.16616289130728126, 0.22546564014882556, 0.12434932749214431, 0.09705449929714216, 0.2430346501031037]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.6913011097321923, 0.6983601023247931, 0.6363640104498426, 0.6626963926707251, 0.6787717786066545, 0.6659978468521316, 0.7228598244114711, 0.6772278464870131, 0.6696809771552915, 0.6649889923509369, 0.6459882598427928, 0.6798807630584336, 0.756945245706371, 0.7777295425657593, 0.7577877013782501, 0.7117145042899953, 0.6616218484421791, 0.7430109697060615, 0.7423068389016771, 0.6870776503979701], [0.24409443634650702, 0.1616188157647193, 0.2087297173095466, 0.1170148351874405, 0.21756608817082018, 0.23140503832387524, 0.23810708539435113, 0.25996393296226206, 0.18922809405363353, 0.21421420019837836, 0.1987318731025963, 0.2521550989070244, 0.22578005425404712, 0.3700300918630345, 0.2164734578044832, 0.20128401073918623, 0.18854555950312374, 0.2571881503658015, 0.17932465232101424, 0.20741913330165065], [0.14170061804493106, 0.03936602119277319, 0.04379522889051919, 0.16383263793858954, 0.09624614152629404, 0.0863086492478302, 0.07899731076171737, 0.07891370486865482, 0.16450158010301744, 0.11775955531305093, 0.07029555738937138, 0.09852252977347035, 0.12839266887427642, 0.08380577490390477, 0.08038655781907834, 0.02484936591756916, 0.0995034597943755, 0.0974475827364054, 0.10203701076216717, 0.1753829417346219], [0.35657492427182547, 0.35073028803994316, 0.27210918271797924, 0.3485828726507345, 0.2625294313539335, 0.25392007061937943, 0.19647065368538869, 0.29683898828235544, 0.3296393201671934, 0.3421222686863174, 0.20250252327322682, 0.34765747084635645, 0.3658538374167415, 0.40427452814260156, 0.2566576373243796, 0.3395301996172905, 0.38251716224231325, 0.34547852445642024, 0.1423573751802451, 0.3018305563148685], [0.06556529495810237, 0.22527706905940031, 0.13338741520354638, 0.11276333941268077, 0.1286080792389431, 0.19889024088718443, 0.16477226760100794, 0.17869473757266507, 0.13577453508314474, 0.17036512136329798, 0.11461707424558189, 0.17039561499662037, 0.11415963295479127, 0.037357573265469866, 0.17465007625482565, 0.029530991532929374, 0.14757406327863384, 0.09892906908815575, 0.08904699366248109, 0.22375015677271703], [0.2403924936740278, 0.26477841428413984, 0.059253197583698694, 0.10708836441473708, 0.10653522403271898, 0.13284900481486003, 0.11048486969198026, 0.15732515226655797, 0.09027416952598123, 0.16811088457961015, 0.06674165387680887, 0.17817598519077374, 0.0613917675736849, 0.08851866290181441, 0.18412258327995587, 0.0715523651117911, 0.07821665633224811, 0.3163080021626661, 0.1532822545193559, 0.10688721995237933]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7523944456188378, 0.7503052458745095, 0.7216290966163188, 0.7342443920370215, 0.7305295250285605, 0.763233512706756, 0.7373876550360375, 0.7437084713604197, 0.7861281735964597, 0.7462378933153941, 0.645531015244096, 0.6962086556395236, 0.7784046208390395, 0.7070808747343564, 0.6266833480122097, 0.7166622600403753, 0.7340010515577129, 0.6482233670573905, 0.6108803408275422, 0.6798768671600391], [0.2789175013343737, 0.14068397797700818, 0.3065326626888505, 0.1407874529498537, 0.3088397980340623, 0.24681967758001358, 0.14299590978386414, 0.2114233817570912, 0.10598297566194975, 0.17979104249287164, 0.15918289125590798, 0.1200375902713663, 0.10791312490379655, 0.24973735876733913, 0.18514732794554684, 0.14786314449115454, 0.1717914673565874, 0.09799341468249818, 0.1596283499805422, 0.1520680102747163], [0.44378392179914306, 0.32925925396796335, 0.20826291021003707, 0.40959205378134494, 0.30165040162559653, 0.3170819418210603, 0.4370812983922232, 0.23794926515538728, 0.35526831629258143, 0.28230879118275426, 0.28626438810863475, 0.48762351817876354, 0.4006662504962564, 0.2990906271401283, 0.24251445124173812, 0.3519852470645935, 0.4211639644006627, 0.26286225911930206, 0.3577828428935072, 0.3293607387329342], [0.33466350685524404, 0.3439103054809389, 0.030445724030834263, 0.19921415609766466, 0.3693686810483766, 0.282504574242167, 0.25620040489368795, 0.24347366162217046, 0.16482188289998304, 0.24188283856655293, 0.270652891496503, 0.19646644401103772, 0.5107413945801481, 0.06689219646646685, 0.1964088140456317, 0.44823266317321, 0.16457551924337124, 0.2967750987052147, 0.30737552409358865, 0.1433867423841837], [0.09202303230760295, 0.25190906543779484, 0.1350096290284758, 0.18664551284237615, 0.14289861183284225, 0.16050751747472333, 0.3114374009489807, 0.21633160845036112, 0.35362873939956574, 0.19216404918079508, 0.10929212696792308, 0.14461101926769662, 0.2286429563130367, 0.09621197651732326, 0.0947327299700094, 0.21745777260191776, 0.18812235607719888, 0.23487042877806566, 0.07086074316921316, 0.19191764892269408]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.8743376618704835, 0.7825033742749153, 0.8994094423066343, 0.7873519440745137, 0.8492627495363925, 0.8819113384895273, 0.7794615513891091, 0.8945944519455666, 0.750317501177779, 0.8831401846674732, 0.8357012584546282, 0.8499996250793945, 0.9151064750294575, 0.855947362166323, 0.8797634701648208, 0.8823884890542053, 0.8620770991030603, 0.8159892995719561, 0.8355763903500381, 0.8890826500309689], [0.4117913497793597, 0.40395695368704254, 0.3478010238043896, 0.36565850833933067, 0.3516169966618407, 0.33913501765436843, 0.45435299117674943, 0.39584156168086987, 0.4798531432176835, 0.3031400198947922, 0.31210813672287224, 0.3379600759038289, 0.2726665218536409, 0.3504636647845836, 0.408155470380237, 0.3545705576753337, 0.45538770593334443, 0.3149316730054427, 0.26150466060524075, 0.31069616749977824], [0.3149506430672889, 0.32222295996572775, 0.32666136168095383, 0.31273680010391364, 0.3208107799495292, 0.2730042310129731, 0.3631829705229609, 0.3997429986994488, 0.36258112658256647, 0.4402271629529729, 0.44488471372086147, 0.3604667759113773, 0.2990708090675693, 0.3683326296844403, 0.26328794988207643, 0.34391587935763984, 0.3727876648569734, 0.3056545005917446, 0.32004181670740445, 0.3205818048782386], [0.4161982515291036, 0.45462992346467274, 0.4023924741208832, 0.3101379911638323, 0.29404575285427803, 0.4025239313714111, 0.495594079386976, 0.348412376710319, 0.4302068415225152, 0.2985334829711699, 0.3720667599803317, 0.32126076352139793, 0.44456712739230736, 0.440659794306504, 0.3243160054607883, 0.422083341266567, 0.45046100930088845, 0.4238484776991399, 0.3649607975278897, 0.31118959066118534]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.7758222601216472, 0.7189607576381334, 0.7433377275829457, 0.8483884884311363, 0.7643538436156059, 0.7547474034349219, 0.7943904288993184, 0.7688005944056466, 0.770244095406019, 0.797002297663943, 0.8691666068422471, 0.8093738860026348, 0.8033456350352595, 0.7869422648027684, 0.8472442995712088, 0.8449547878331399, 0.816430985340783, 0.8190158573110918, 0.8452075384818919, 0.7516890329370407], [0.19122965622511634, 0.22822318646258574, 0.2916641853354132, 0.30000848687924175, 0.21174778256809984, 0.28800423008297305, 0.23912677867093748, 0.2274286116426057, 0.2572975552589957, 0.24691275129962564, 0.3213048812668642, 0.38123765802327864, 0.26215311482190246, 0.22290738291731013, 0.2926413813222105, 0.23876044220282275, 0.25611464688703395, 0.3078357791108123, 0.2614359262653353, 0.3255257219606922], [0.2680419269967878, 0.3740940928820516, 0.3025206458614655, 0.33786607841460553, 0.3340120587742833, 0.2934111614023705, 0.35383831270331223, 0.2792825050219611, 0.3180147590950773, 0.3140644724617076, 0.35908429717570467, 0.3683164465464467, 0.25394440186359085, 0.33962355146070344, 0.27870309671614246, 0.28774927046995125, 0.3295509993066075, 0.38341378747982086, 0.278661443633697, 0.3490438086221133]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.87523296132351, 0.792842824522438, 0.9039141946048186, 0.845557436779784, 0.7677556694233636, 0.9017896178493967, 0.9152210140640481, 0.8771054597034492, 0.9139228474491372, 0.8382615789768485, 0.9075249979841304, 0.8905605084573419, 0.7456037329401759, 0.8662248197074568, 0.8385379846176886, 0.8548748736781356, 0.8235681135850672, 0.8342774644730999, 0.8780469580719246, 0.8895740511771094], [0.5827280887936245, 0.4814172187252445, 0.4810078987153523, 0.5637776139192083, 0.555991308936543, 0.5508383588340445, 0.5178112584121437, 0.40435072547024353, 0.4891093434478244, 0.4134651142195558, 0.3591431872810797, 0.4159725771721547, 0.4266954468742107, 0.540058621348199, 0.533758791579474, 0.5188479458376476, 0.5648989895198646, 0.4148642666340235, 0.46804239513707624, 0.5035016045520336]], [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.8816951092048891, 0.8141162965564357, 0.8931524185215706, 0.8265915715915901, 0.8159826791961503, 0.8103342225932758, 0.8204443002723628, 0.8223809958497823, 0.8315406417084616, 0.8697201333573222, 0.8508346973234197, 0.8818387494262352, 0.8149595588314352, 0.8954945403709959, 0.8955046651882701, 0.8923794555183127, 0.9000329244583203, 0.8416468383313058, 0.8082449108614574, 0.8229764718875879]]])

#so.npprint(np.median(dist_raw, axis=2)*10)
#so.npprint(np.median(sim_diag, axis=2)*10)

def normalize_dist(d,d2,rev=False):
    # input diag matrix 
    d = np.array(d)
    for i in range(d.shape[0]):
        for j in range(d.shape[1]):
            if i!=j:
                for z in range(d.shape[2]):
                    d1 = d2[i,i]  +  d2[j,j] 
                    m = d1/2
                    if rev:
                        m = 2/d1
                    d[i,j,z] =  d[i,j,z]*m  # or the other way araound
    return d


def mirror(d, copy=False):
    if copy:
        d=np.array(d)
    for i in range(d.shape[0]): 
        for j in range(i,d.shape[1]):
            if j!=i:
                d[j,i]=d[i,j]
    return d

def draw_cloud(dist3d, clust3d, row):
    #for d1 in range(dist3d.shape[0]):
    for d2 in range(dist3d.shape[1]):
        plt.scatter(dist3d[row,d2], clust3d[row,d2])
    plt.show()




#%%
# distance boxplot testis
#################

# 1. difference between dist_raw and sim_diag
for r1 in range(dist_raw.shape[0]):
    a= np.median(dist_raw[r1,r1])
    b= np.median(sim_diag[r1,r1]) 
    print(a,b)

# 2. boxplot distances: 
dbox.boxes(sim_diag)

#%% 
########################
# cluster together vs distance 
#######################
distM = mirror(dist_raw, copy= True)
distM2d = np.median(distM,axis=2)
row = np.argmax(distM2d.sum(axis=1))

sd = mirror(sim_diag)
cp = mirror(combi_perf)
for row in [3]:#range(8):
    print("row", row)
    draw_cloud(sim_diag,combi_perf,row) 
    draw_cloud(sim_diag,combi_perf15,row) 


#%%
# 4. cluster row, but we change the distance a bit
# MOLLA
###################

distM = mirror(sim_diag, copy= True)
distM2d = np.median(distM,axis=2)
sim_diag_m1= normalize_dist(distM,distM2d, rev=False)
sim_diag_m2= normalize_dist(distM,distM2d, rev=True)
draw_cloud(sim_diag_m1,combi_perf,row) 
draw_cloud(sim_diag_m2,combi_perf15,row) 




# %%
# 100 DATA.. 
#######################

# load distance matrix for 100x100 and the labels
alldata = eval(open("/home/ikea/data/100x.lst",'r').read())
alldata=np.array(alldata)
alldata[alldata==-1]=np.nan
z = np.nanmean(alldata,axis=2)

# labels
names = input.get100names("/home/ikea/data/data")
labs = [n[:5] for n in names]
items = np.unique(labs)
s= spacemap(items)
nulabels = [s.getint[e] for e in labs  ] 
nulabels=np.array(nulabels)

# %%

def scatter(u):
    for item in items:
        X = u[nulabels==s.getint[item]]
        plt.scatter(X[:,0], X[:,1],label=item, color=draw.col[s.getint[item]])
    plt.legend()
    plt.show()

for n in [8]: #range(2,10):
    print ("neighbors",n)
    fit = umap.UMAP(n_neighbors=3)
    u = fit.fit_transform(z)
    scatter(u)


# %%
import seaborn as sns 
colz = [draw.col[x] for x in nulabels]
g=sns.clustermap(z,row_colors = colz, col_colors = colz)

for label in s.integerlist:
    g.ax_col_dendrogram.bar(0, 0, color=draw.col[label],
                            label=s.getitem[label], linewidth=0)

g.ax_heatmap.tick_params(right=False, bottom=False)
g.ax_heatmap.set(xticklabels=[])
g.ax_heatmap.set(yticklabels=[])

g.ax_col_dendrogram.legend( ncol=7, bbox_to_anchor=(1,-4.1))
# %%
# CLUSTER PERFORMANCE VS SIMILARITY , SIM > .5
###############################


# TODO :  measure clusterperformance by
#  px+py - perf(x+y) / (p(x)+p(y)) <- something like that

import pprint
distances=[]
dataset_names = []
for a in range(z.shape[0]):
    for b in range(z.shape[1]):
        if a>=b and z[a,b]>0.3:
            dataset_names.append((names[a],names[b]))
            distances.append(alldata[a,b].tolist())

#cluster_performance = eval(open("/home/ikea/data/boxbox_a.ev",'r').read())
cluster_performance = np.array(eval(open("/home/ikea/data/point3.1.ev",'r').read()))


def docalc(combi, d1,d2):
    # calculates increase for clustering jointly
    return combi / max(d1,d2)
    #return 2*combi / (d1+d2)


def addbox(rrr, color):
    a,b = Transpose(rrr)
    data = b 
    position = np.median(a)
    plt.boxplot(data,positions=[position])
    data = a 
    position = np.median(b)
    plt.boxplot(data,positions=[position],vert=False)
    #ugdraw.boxplot(b,position)


def draw_cloud(distances, cluster_performance, datalabels):
    same_name=[]
    same_type=[]
    same_nothing=[]

    for a,b,labels in zip(distances, cluster_performance,datalabels):
        n1,n2 = labels
        if b[0][0]>-1:
            simp = (np.median(a),np.median(b[:,0]))

            clusterscore = [ docalc(*abc) for abc in b ]
            simp = np.median(a), np.median(clusterscore)
            if n1==n2:
                same_name.append(simp)
            elif n1[:5] == n2[:5]:
                same_type.append(simp)
            else:
                same_nothing.append(simp)

    #addbox(same_name,'red')
    #addbox(same_nothing,'red')
    #addbox(same_type,'red')
    plt.scatter(*Transpose(same_nothing),marker='o',color='blue',label=f'unrelated ({len(same_nothing)})')
    plt.scatter(*Transpose(same_name),marker='o',color='red', label=f'same dataset({len(same_name)})')
    plt.scatter(*Transpose(same_type),marker='o',color='magenta', label=f'same celltype ({len(same_type)})')
    plt.legend()
    
    x = [x/10 for x in range(3,11)]
    plt.xticks(x,labels=x)


    allmarks=same_name+same_type+same_nothing
    #print('spearman black',spear(Transpose(s1)))
    s1,s2=Transpose(allmarks)
    mylr = LR() #RANSACRegressor()
    s1=np.array(s1).reshape(-1,1)
    mylr.fit(s1,s2)
    stuff =[.3,1]
    plt.plot(stuff, [mylr.predict([[x]]) for x in stuff])



    plt.xlabel("similarity ")
    plt.ylabel("cluster performance (joint/max(a,b))")
    plt.gca().set_aspect('equal', adjustable='box')
    plt.show()


draw_cloud(distances,cluster_performance,dataset_names)





# %%

################
# here i will draw the clustermap for 
# repeated sampling 
##############
#distance_fake_multi.ev
DATA  = eval(open("/home/ikea/data/distance_fake_multi.ev",'r').read())
DATA2  = eval(open("/home/ikea/data/distance_fake_multi_remake.ev",'r').read())
DATA = np.array(DATA)
DATA2 = np.array(DATA2)

# use just 1 random slide
DATA = DATA[:,:,2]
DATA2 = DATA2[:,:,2]

# for adding i should make the missing things 0 ...
DATA[DATA==-1]=0
DATA2[DATA2==-1]=0



DATA= np.add(DATA,DATA2)

sns.heatmap(DATA);plt.show()
sns.heatmap(DATA2);plt.show()

#%%
LABELS  = eval(open("/home/ikea/data/distance_fake_multi_labels.ev",'r').read())
LABELS  = [l[:5] for l in LABELS] 
 

items = np.unique(LABELS)
s= spacemap(items)
nulabels = [s.getint[e] for e in LABELS  ] 
nulabels=np.array(nulabels)


import seaborn as sns 
colz = [draw.col[x] for x in nulabels]
g=sns.clustermap(DATA,row_colors = colz, col_colors = colz)

for label in s.integerlist:
    g.ax_col_dendrogram.bar(0, 0, color=draw.col[label],
                            label=s.getitem[label], linewidth=0)

g.ax_col_dendrogram.legend(loc="center", ncol=5)
g.ax_heatmap.tick_params(right=False, bottom=False)
g.ax_heatmap.set(xticklabels=[])
g.ax_heatmap.set(yticklabels=[])

g.ax_col_dendrogram.legend( ncol=7, bbox_to_anchor=(1,-4.1))
# %%
